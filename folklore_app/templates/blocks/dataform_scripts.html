<script>
    var geo_text_1 = document.getElementById("region");
    var geo_text_2 = document.getElementById("district");
    var geo_text_3 = document.getElementById("village");

    var geo_text_dataObj = {{ selection['geo_text']|tojson }};

    let geo_text_ctrs = Object.keys(geo_text_dataObj);
    cmo(geo_text_ctrs, geo_text_1);
    _1sel_geo_text();

    function _1sel_geo_text() {
        geo_text_2.innerHTML = "";//clear the target select
        let districts = Object.keys(geo_text_dataObj[geo_text_1.value]);//get the cities from country as array
        cmo(districts, geo_text_2);
        _2sel_geo_text();
    }

    function _2sel_geo_text() {
        geo_text_3.innerHTML = "";//clear
        let villages = geo_text_dataObj[geo_text_1.value][geo_text_2.value];
        cmo(villages, geo_text_3);
    }

    function cmo(arr, s) {//create options and add to select
        arr.forEach(o => {
            let opt = document.createElement("option");
            opt.value = o;
            opt.innerHTML = o;
            s.add(opt);
        });
    }
</script>

<script type="text/javascript">
    $(function() {
        $('#keywords').tagsInput({
            'autocomplete': {
                source: {{ selection['keywords']|tojson }}
            },
            'delimiter': ';',
            'whitelist': {{ selection['keywords']|tojson }}
        });

    });
</script>